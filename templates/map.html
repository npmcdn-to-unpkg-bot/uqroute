<!DOCTYPE html>
<html>
  	<head>
		<title>UQRoute - Success!</title>
		<link href="{{url_for('static', filename='css/bootstrap.min.css')}}" rel="stylesheet">
    	<link rel="shortcut icon" href="{{url_for('static', filename='favicon.png')}}">
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    	<style>
			#map {
				width: 100%;
				height: 400px;
			}
			.centalign {
				text-align: center;
			}
			.centalign img {
				margin: 0 auto;
			}
			.footer {
				position: absolute;
				bottom: 0;
				width: 100%;
				/* Set the fixed height of the footer here */
				height: 25px;
				text-align: center;
				}
			.footer a {
					text-decoration: none;
				}
			.blue {
					color: #0072bb;
				}
			.onehundred {
				width: 100%;
			}
    	</style>
  	</head>
  	<body>
    <section>
        <div class="container" id = "cont">
            <div class="row centalign">
                <img class="img-responsive img-center" src="static/LOGO.png" alt="" width="400" height="400">
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <!--<h1 class="section-heading">Section Heading</h1> -->
                    <p class="lead section-lead"><center>After some serious number crunching, we found the best route for you. <br/> Here's what we recommend...</p></center>
                </div>
            </div>
			<div class="row">
				<div id="map"></div>
			</div>
			<br>
        	<div class="row centalign onehundred">
				<p>Your total walking distance is <span id="distance">0</span>m. That's the equivalent of about <span id=calories>0</span> calories.</p>
			<div>
		</div>
    </section>
    <script>
      function initMap() {
        var mapDiv = document.getElementById('map');
	var directionsService = new google.maps.DirectionsService();
	var directionsDisplay = new google.maps.DirectionsRenderer();
	var points = [];
	
	{% for e in nodes %}
		points.push({
			location: {
				lat: {{e["lat"]}},
				lng: {{e["lng"]}}
				}});
	{% endfor %}	


	points.pop();
	points.shift();
	var directionRequest = {
	origin: {
		lat: {{nodes[0]["lat"]}},
		lng: {{nodes[0]["lng"]}}
		},
	destination: { 
		lat: {{nodes[-1]["lat"]}},
		lng: {{nodes[-1]["lng"]}}
		},
	travelMode: 'WALKING',
	waypoints: points
	};
        var map = new google.maps.Map(mapDiv, {
		center: {
		lat: {{nodes[0]["lat"]}},
		lng: {{nodes[0]["lng"]}}
		},	
            	zoom: 16
        });
	directionsDisplay.setMap(map);
	
	directionsService.route(directionRequest, function(result, status) {
		if (status == 'OK') {
			directionsDisplay.setDirections(result);
		}
      });
}
    </script>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAEyThZHPQoC29JrKGTmph-qxF2R3mVJXI&callback=initMap">
    </script>
  </body>
	<footer class="footer">
        <div class="container center blue">
            <p>Created by <a href="https://github.com/tgrkzus">Tom Richardson</a>, <a href="https://au.linkedin.com/in/lachlan-jensen-6456b9117">Lachlan Jensen</a> & <a href="https://au.linkedin.com/in/nicholas-d-lambourne-07b782a2">Nicholas Lambourne</a></p>
        </div>
    </footer>
</html>
